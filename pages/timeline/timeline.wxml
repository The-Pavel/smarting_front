<!--pages/timeline/timeline.wxml-->

  <input bindfocus="remove_search" class='image_search' placeholder='What are you feeling today?' placeholder-class='search_place' maxlength='15' bindconfirm='image_search'></input>

  <view wx:if="{{image_selected && !text_added}}">
    <image class="created_card" data-id='{{selected_image.id}}' bindtap="unselect_image" src='{{selected_image.images.original.url}}'></image>
  </view>

  <view wx:if="{{image_selected && text_added}}" class="created_card" style="background-image: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.5)), url({{selected_image.images.original.url}})">
  {{user_content}}
  </view>

  <input class='image_search' placeholder='Share your thoughts with the world' placeholder-class='search_place' maxlength='100' bindconfirm='add_text'></input>

  <view wx:if='{{text_added && image_selected}}' class="button_box">
    <button type='default' bindtap='start_over'>Start over</button>
    <button type='primary' bindtap='create_post'>Share</button>
  </view>

  <view wx:if="{{search_done}}">
    <view class="timeline" wx:for="{{searched_images}}" wx:for-item="image" wx:key="id">
      <image data-id='{{image.id}}' class='card-category' bindtap="select_image" src='{{image.images.original.url}}'/>
    </view>
  </view>  

<view class="timeline" wx:for="{{posts}}" wx:for-item="post" wx:key="id">
  <view data-id='{{post.id}}' class="card-category" style="background-image: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.5)), url({{post.image}})">
  {{post.content}}
    <view bindtap='toggle_comments' data-id='{{post.id}}' class='comment_count'>{{post.comments.length}} comments</view>
    <view wx:if="{{post.comment_toggle}}">
      <view class='comment_section'>
      <block wx:for="{{post.comments}}" wx:for-item="comment" wx:key="id">
        <view  class='comment_line' bindtap='toggle_comments' data-id='{{post.id}}'>{{comment.name}}: {{comment.text}}</view>
      </block>
      <input class='comment_input' data-id='{{post.id}}' bindconfirm='send_comment' placeholder='Leave a comment'></input>
      </view>
    </view>
  </view>
</view>